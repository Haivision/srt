name: iOS

on:
  push:
    branches: [ "master", "dev" ]
  pull_request:
    branches: [ "master", "dev" ]

jobs:
  build:
    strategy:
      matrix:
        cxxstdsync: [ON] #[OFF, ON] # cxxsync=off is Linux-gcc-only.

    name: iOS-cxxsync${{ matrix.cxxstdsync }}
    runs-on: macos-latest

    steps:
    - uses: actions/checkout@v3
    - name: Install dependency packages
      run: |
         brew install make      
    - name: configure
      run: |
        mkdir _build && cd _build
        cmake ../ -DENABLE_ENCRYPTION=OFF -DENABLE_STDCXX_SYNC=${{matrix.cxxstdsync}} -DENABLE_MONOTONIC_CLOCK=OFF -DENABLE_UNITTESTS=OFF -DUSE_CXX_STD=c++11 -DENABLE_BONDING=ON --toolchain scripts/iOS.cmake
    - name: build
      run: cd _build && cmake --build ./
